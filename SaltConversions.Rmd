---
title: "Salt Conversions"
authors: "Amanda Pennino, Stephen Plont"
date: "4/5/2021"
output: html_document
---

```{r}
library(tidyverse)

```

```{r message= FALSE}

DATA <- read_csv("data/RawSalts_Clean.csv") 

#unique(sort(DATA$SaltUnits))
#unique(sort(DATA$Measurement))


```


Step 1: Easy unit conversions of conductivity units to uS/cm (microSiemens per centimeter)



Notes from "Measurement = Conductivity"(SP 20210411)
-mhos
  -Recheck papers to see if there is a denominator in the unit (should be mhos/cm or mhos/m, etc.)
  -RefID = 217, Reviewer = Sally
-mmhos
  -Recheck papers to see if there is a denominator in the unit (should be mmhos/cm or mmhos/m, etc.)
  -RefID = 406, Reviewer = Rich
-mg/L
  -Recheck papers to see if this should be labeled under "conductivity" or as "salt/ion"
  -Or is the "mg/L" measurement linked to an ion or salt equivalent? (e.g., mg/L as Cl)
  -RefID = 453, Reviewer = Rich
  -RefID = 506, Reviewer = Rich
  -RefID = 26, Reviewer = Abigail
  -RefID = 266, Reviewer = Carl
-ug/L
  -Recheck papers to see if this should be labeled under "conductivity" or as "salt/ion"
  -Or is the "ug/L" measurement linked to an ion or salt equivalent? (e.g., ug/L as Cl)
  -RefID = 421, Reviewer = Abigail
-ppt
  -Recheck papers to see if this should be labeled under "conductivity" or as "salt/ion" or as "Total Dissolved Solids"
  -Or is the "ppt" measurement linked to an ion or salt equivalent? (e.g., ppt as Cl)
  -RefID = 409, Reviewer = Rich
  -RefID = 107, Reviewer = Paul
-Not provided
  -Should we just label these as NA's?


Conversions to uS/cm
```{r}
CONDUCTANCE <- DATA %>% 
  filter(Measurement %in% c("Salinity", "Natural Seawater", "Hardness", "Total Dissolved Solids", "NaCl dominant (ion matrix similar to seawater)","Varies (Table 4)", "Conductivity", "total suspended solids", "Specific Conductance"))  


CONDUCTANCE$Min_Conductivity_uScm=NA
CONDUCTANCE$Max_Conductivity_uScm=NA

#umhos/cm (umhos/cm = uS/cm)
##### ppt (parts per thousand)
CONDUCTANCE$Min_Conductivity_uScm<-ifelse(CONDUCTANCE$SaltUnits == "µmho/cm", 
                                         CONDUCTANCE$`Minimum concentration_original`,
                                         IONS$Min_Conductivity_uScm)


umhos.cm<-subset(CONDUCTANCE, SaltUnits=="µmho/cm")
umhos.cm$Min_Conductivity_uScm=umhos.cm$`Minimum concentration_original`
umhos.cm$Max_Conductivity_uScm=umhos.cm$`Maximum concentration_original`
 
#dS/m (multiply by 100000 to get from deci to micro, divide by 100 to get from meter to centimeter)
dS.m<-subset(CONDUCTANCE, SaltUnits=="dS/m")
dS.m$Min_Conductivity_uScm=dS.m$`Minimum concentration_original`*(100000/100)
dS.m$Max_Conductivity_uScm=dS.m$`Maximum concentration_original`*(100000/100)

#mmhos/cm (mmhos/cm = mS/cm, multiply by 1000 to get from milli to micro)
mmhos.cm<-subset(CONDUCTANCE,SaltUnits=="mmhos/cm")
mmhos.cm$Min_Conductivity_uScm=mmhos.cm$`Minimum concentration_original`*1000
mmhos.cm$Max_Conductivity_uScm=mmhos.cm$`Maximum concentration_original`*1000

#uS/cm (uS/cm = uS/cm)
uS.cm<-subset(CONDUCTANCE,SaltUnits=="µS/cm")
uS.cm$Min_Conductivity_uScm=uS.cm$`Minimum concentration_original`
uS.cm$Max_Conductivity_uScm=uS.cm$`Maximum concentration_original`
       
#mS/cm (multiply by 1000 to get from milli to micro)
mS.cm<-subset(CONDUCTANCE,SaltUnits=="mS/cm")
mS.cm$Min_Conductivity_uScm=mS.cm$`Minimum concentration_original`*1000
mS.cm$Max_Conductivity_uScm=mS.cm$`Maximum concentration_original`*1000

#mS/m (multiply by 1000 to get from milli to micro, divide by 100 to get from meter to centimeter)
mS.m<-subset(CONDUCTANCE,SaltUnits=="mS/m")
mS.m$Min_Conductivity_uScm=mS.m$`Minimum concentration_original`*10
mS.m$Max_Conductivity_uScm=mS.m$`Maximum concentration_original`*10
    
#uS/m (divide by 100 to get from meter to centimeter)
uS.m<-subset(CONDUCTANCE,SaltUnits=="µS/m")
uS.m$Min_Conductivity_uScm=uS.m$`Minimum concentration_original`/100
uS.m$Max_Conductivity_uScm=uS.m$`Maximum concentration_original`/100

CONDUCTANCE<-rbind(umhos.cm,dS.m,mmhos.cm,uS.cm,mS.cm,mS.m,uS.m)


```

Notes (SP 20210411)

-Here is some spaghetti code 

```{r}

    #mhos
    #***RECHECK UNITS IN PAPER***
    mhos<-subset(DATA,SaltUnits=="mhos")
    mhos$Min_Conductivity_uScm=NA
    mhos$Max_Conductivity_uScm=NA

    #mhmos
    #***RECHECK UNITS IN PAPER***
    mmhos<-subset(DATA,SaltUnits=="mhmos")
    mmhos$Min_Conductivity_uScm=NA
    mmhos$Max_Conductivity_uScm=NA
    
Conductivity<-subset(DATA, Measurement == "Conductivity")

    #mg/L
    #***RECHECK UNITS/TYPE OF MEASUREMENT IN PAPER***
    mg.L<-subset(Conductivity,SaltUnits=="mg/L")
    mg.L$Min_Conductivity_uScm=NA
    mg.L$Max_Conductivity_uScm=NA
    
    #ug/L
    #***RECHECK UNITS/TYPE OF MEASUREMENT IN PAPER***
    ug.L<-subset(Conductivity,SaltUnits=="µg/L")
    ug.L$Min_Conductivity_uScm=NA
    ug.L$Max_Conductivity_uScm=NA
    
    #ppt
    #***RECHECK UNITS/TYPE OF MEASUREMENT IN PAPER***
    ppt<-subset(Conductivity,SaltUnits=="ppt")
    ppt$Min_Conductivity_uScm=NA
    ppt$Max_Conductivity_uScm=NA
    
    #Not provided
    #***RECHECK UNITS IN PAPER***
    notprovided<-subset(Conductivity,SaltUnits=="Not provided")
    notprovided$Min_Conductivity_uScm=NA
    notprovided$Max_Conductivity_uScm=NA

ALLCOND<-rbind(newDATA,mhos,mmhos,mg.L,ug.L,ppt,notprovided)
write.csv(ALLCOND, "allconductivitystudies.csv")

unique(ALLCOND$RefID)
```


Notes (SP 20210411)

-Lead on converting TDS to conductivity -> Correlation between conductivity and total dissolved solid in various type of water: A review
To cite this article: Anna F Rusydi 2018 IOP Conf. Ser.: Earth Environ. Sci. 118 012019
    -Pretty simple conversion factor, but changes for freshwater vs. salt water (so maybe we have a two compartment conversion?)

```{r}

#What and how many different units are we dealing with
Salinity<-subset(DATA, Measurement == "Salinity")
unique(sort(Salinity$SaltUnits))

TDS<-subset(DATA, Measurement == "Total Dissolved Solids" | Measurement == "total suspended solids" | Measurement == "total ions")
unique(sort(TDS$SaltUnits))

```

Conversions to ppm, ion-specific.
```{r}


IONS <- DATA %>% 
  filter(!Measurement %in% c("Salinity", "Natural Seawater", "Hardness", "Total Dissolved Solids", "NaCl dominant (ion matrix similar to seawater)","Varies (Table 4)", "Conductivity", "total suspended solids", "Specific Conductance"))                                      
                                             

IONS$Min_Concentration_ppm <- NA
IONS$Max_Concentration_ppm <- NA

##### ppt (parts per thousand)
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "ppt", 
                                         IONS$`Minimum concentration_original` * 1000,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "ppt", 
                                         IONS$`Maximum concentration_original` * 1000,
                                         IONS$Max_Concentration_ppm)


##### ppb
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "ppb", 
                                         IONS$`Minimum concentration_original` / 1000,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "ppb", 
                                         IONS$`Maximum concentration_original` / 1000,
                                         IONS$Max_Concentration_ppm)


##### g/L
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "g/L", 
                                         IONS$`Minimum concentration_original` * 1000,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "g/L", 
                                         IONS$`Maximum concentration_original` * 1000,
                                         IONS$Max_Concentration_ppm)


##### mg/L
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mg/L", 
                                         IONS$`Minimum concentration_original`, 
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mg/L", 
                                         IONS$`Maximum concentration_original`, 
                                         IONS$Max_Concentration_ppm)


##### ppm
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "ppm", 
                                         IONS$`Minimum concentration_original`, 
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "ppm", 
                                         IONS$`Maximum concentration_original`, 
                                         IONS$Max_Concentration_ppm)


##### ug/L
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "µg/L", 
                                         IONS$`Minimum concentration_original` / 1000,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "µg/L", 
                                         IONS$`Maximum concentration_original` / 1000,
                                         IONS$Max_Concentration_ppm)



##### %
# IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "%", 
#                                          IONS$`Minimum concentration_original` * 10000,
#                                          IONS$Min_Concentration_ppm)
# 
# IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "%", 
#                                          IONS$`Maximum concentration_original` * 10000,
#                                          IONS$Max_Concentration_ppm)



##### µmol/L

#NH4+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "NH4+", 
                                         IONS$`Minimum concentration_original` / 1000000 * 1000 * 18.04,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "NH4+", 
                                         IONS$`Maximum concentration_original` / 1000000 * 1000 * 18.04,
                                         IONS$Max_Concentration_ppm)


#Ca2+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits %in% c("µmol/L") & IONS$Measurement== "Ca2+", 
                                         IONS$`Minimum concentration_original` / 1000000 * 1000 * 40.08,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits %in% c("µmol/L") & IONS$Measurement== "Ca2+", 
                                         IONS$`Maximum concentration_original` / 1000000 * 1000 * 40.08,
                                         IONS$Max_Concentration_ppm)


#HCO3-
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "HCO3-", 
                                         IONS$`Minimum concentration_original` / 1000000 * 1000 * 61.02,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "HCO3-", 
                                         IONS$`Maximum concentration_original` / 1000000 * 1000 * 61.02,
                                         IONS$Max_Concentration_ppm)


#K+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "K+", 
                                         IONS$`Minimum concentration_original` / 1000000 * 1000 * 39.09,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "K+", 
                                         IONS$`Maximum concentration_original` / 1000000 * 1000 * 39.09,
                                         IONS$Max_Concentration_ppm)

#Mg3+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "Mg3+", 
                                         IONS$`Minimum concentration_original` / 1000000 * 1000 * 24.31,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "Mg3+", 
                                         IONS$`Maximum concentration_original` / 1000000 * 1000 * 24.31,
                                         IONS$Max_Concentration_ppm)


#Na+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "Na+", 
                                         IONS$`Minimum concentration_original` / 1000000 * 1000 * 22.99,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "µmol/L" & IONS$Measurement== "Na+", 
                                         IONS$`Maximum concentration_original` / 1000000 * 1000 * 22.99,
                                         IONS$Max_Concentration_ppm)




#mmol/L
#NaCl
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "NaCl", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 58.44,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "NaCl", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 58.44,
                                         IONS$Max_Concentration_ppm)



#Ca2+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Ca2+", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 40.08,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Ca2+", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 40.08,
                                         IONS$Max_Concentration_ppm)



#K+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "K+", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 39.09,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "K+", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 39.09,
                                         IONS$Max_Concentration_ppm)



#Mg3+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Mg3+", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 24.31,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Mg3+", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 24.31,
                                         IONS$Max_Concentration_ppm)


#Na+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Na+", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 22.99,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Na+", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 22.99,
                                         IONS$Max_Concentration_ppm)



#Cl-
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Cl-", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 35.45,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "Cl-", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 35.45,
                                         IONS$Max_Concentration_ppm)


#CaCl2
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "CaCl2", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 110.98,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "CaCl2", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 110.98,
                                         IONS$Max_Concentration_ppm)

#KCl
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "KCl", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 74.55,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "KCl", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 74.55,
                                         IONS$Max_Concentration_ppm)


#NH4+
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "NH4+", 
                                         IONS$`Minimum concentration_original` / 1000 * 1000 * 18.04,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "mmol/L" & IONS$Measurement== "NH4+", 
                                         IONS$`Maximum concentration_original` / 1000 * 1000 * 18.04,
                                         IONS$Max_Concentration_ppm)


#uEq/L  
#NaHCO3, sodium bicarbonate
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "uEq/L" & IONS$Measurement== "NaHCO3", 
                                         IONS$`Minimum concentration_original` / 1000 * 84.0,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "uEq/L" & IONS$Measurement== "NaHCO3", 
                                         IONS$`Maximum concentration_original` / 1000 * 84.0,
                                         IONS$Max_Concentration_ppm)

#(NH4)2SO4 ; ammonium sulfate
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "uEq/L" & IONS$Measurement== "(NH4)2SO4", 
                                         IONS$`Minimum concentration_original` / 1000 * 132.14,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "uEq/L" & IONS$Measurement== "(NH4)2SO4", 
                                         IONS$`Maximum concentration_original` / 1000 * 132.14,
                                         IONS$Max_Concentration_ppm)


#KHCO3 ; potassium bicarbonate
IONS$Min_Concentration_ppm<-ifelse(IONS$SaltUnits== "uEq/L" & IONS$Measurement== "KHCO3", 
                                         IONS$`Minimum concentration_original` / 1000 * 100.115,
                                         IONS$Min_Concentration_ppm)

IONS$Max_Concentration_ppm<-ifelse(IONS$SaltUnits== "uEq/L" & IONS$Measurement== "KHCO3", 
                                         IONS$`Maximum concentration_original` / 1000 * 100.115,
                                         IONS$Max_Concentration_ppm)




unique(IONS$SaltUnits)

 

#ref <- IONS[(is.na(IONS$Max_Concentration_ppm)), ]

#Check for stragglers (no new data). Likely a name that needs to be fixed in 'DataCleaning' and then added above to conversDATA. 
```
 

